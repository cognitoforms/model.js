!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.exomodel={})}(this,function(e){"use strict";var a="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function t(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function n(e,t){return e(t={exports:{}},t.exports),t.exports}var p=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e){this.unsub=e,this.propagationStopped=!1}return e.prototype.stopPropagation=function(){this.propagationStopped=!0},e}();t.EventManagement=n});t(p);p.EventManagement;var o=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){this.handler=e,this.isOnce=t,this.isExecuted=!1}return e.prototype.execute=function(e,t,n){if(!this.isOnce||!this.isExecuted){this.isExecuted=!0;var r=this.handler;e?setTimeout(function(){r.apply(t,n)},1):r.apply(t,n)}},e}();t.Subscription=n});t(o);o.Subscription;var r=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this._wrap=new i(this),this._subscriptions=new Array}return e.prototype.subscribe=function(e){var t=this;return e&&this._subscriptions.push(new o.Subscription(e,!1)),function(){t.unsubscribe(e)}},e.prototype.sub=function(e){return this.subscribe(e)},e.prototype.one=function(e){var t=this;return e&&this._subscriptions.push(new o.Subscription(e,!0)),function(){t.unsubscribe(e)}},e.prototype.has=function(t){return!!t&&this._subscriptions.some(function(e){return e.handler==t})},e.prototype.unsubscribe=function(e){if(e)for(var t=0;t<this._subscriptions.length;t++)if(this._subscriptions[t].handler==e){this._subscriptions.splice(t,1);break}},e.prototype.unsub=function(e){this.unsubscribe(e)},e.prototype._dispatch=function(r,i,o){for(var s=this,e=function(e){var t=new p.EventManagement(function(){return s.unsub(e.handler)}),n=Array.prototype.slice.call(o);if(n.push(t),e.execute(r,i,n),a.cleanup(e),!r&&t.propagationStopped)return"break"},a=this,t=0,n=this._subscriptions.slice();t<n.length;t++){if("break"===e(n[t]))break}},e.prototype.cleanup=function(e){if(e.isOnce&&e.isExecuted){var t=this._subscriptions.indexOf(e);-1<t&&this._subscriptions.splice(t,1)}},e.prototype.asEvent=function(){return this._wrap},e.prototype.clear=function(){this._subscriptions.splice(0,this._subscriptions.length)},e}();t.DispatcherBase=n;var r=function(){function e(){this._events={}}return e.prototype.get=function(e){var t=this._events[e];return t||(t=this.createDispatcher(),this._events[e]=t)},e.prototype.remove=function(e){delete this._events[e]},e}();t.EventListBase=r;var i=function(){function e(t){this._subscribe=function(e){return t.subscribe(e)},this._unsubscribe=function(e){return t.unsubscribe(e)},this._one=function(e){return t.one(e)},this._has=function(e){return t.has(e)},this._clear=function(){return t.clear()}}return e.prototype.subscribe=function(e){return this._subscribe(e)},e.prototype.sub=function(e){return this.subscribe(e)},e.prototype.unsubscribe=function(e){this._unsubscribe(e)},e.prototype.unsub=function(e){this.unsubscribe(e)},e.prototype.one=function(e){return this._one(e)},e.prototype.has=function(e){return this._has(e)},e.prototype.clear=function(){this._clear()},e}();t.DispatcherWrapper=i});t(r);r.DispatcherBase,r.EventListBase,r.DispatcherWrapper;var u=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.DispatcherBase=r.DispatcherBase,t.DispatcherWrapper=r.DispatcherWrapper,t.EventListBase=r.EventListBase,t.Subscription=o.Subscription});t(u);u.DispatcherBase,u.DispatcherWrapper,u.EventListBase,u.Subscription;var i=n(function(e,t){var r,n=a&&a.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.dispatch=function(e,t){this._dispatch(!1,this,arguments)},t.prototype.dispatchAsync=function(e,t){this._dispatch(!0,this,arguments)},t.prototype.asEvent=function(){return e.prototype.asEvent.call(this)},t}(u.DispatcherBase);t.EventDispatcher=i;var o=function(e){function t(){return e.call(this)||this}return n(t,e),t.prototype.createDispatcher=function(){return new i},t}(u.EventListBase);t.EventList=o;var s=function(){function e(){this._events=new o}return Object.defineProperty(e.prototype,"events",{get:function(){return this._events},enumerable:!0,configurable:!0}),e.prototype.subscribe=function(e,t){this._events.get(e).subscribe(t)},e.prototype.sub=function(e,t){this.subscribe(e,t)},e.prototype.unsubscribe=function(e,t){this._events.get(e).unsubscribe(t)},e.prototype.unsub=function(e,t){this.unsubscribe(e,t)},e.prototype.one=function(e,t){this._events.get(e).one(t)},e.prototype.has=function(e,t){return this._events.get(e).has(t)},e}();t.EventHandlingBase=s});t(i);i.EventDispatcher,i.EventList,i.EventHandlingBase;var s=n(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.EventDispatcher=i.EventDispatcher,t.EventHandlingBase=i.EventHandlingBase,t.EventList=i.EventList});t(s);var c=s.EventDispatcher;s.EventHandlingBase,s.EventList;function l(e,t){var n,r=t;return r.constructor===String?(n=r.split("."),r=window,n.forEach(function(e){if(void 0===(r=r[e]))throw new Error('Parent namespace "'+t+'" could not be found.')})):null==r&&(r=window),e in r?r[e]:r[e]={}}var f=/function\s*([\w_\$]*)/i;function h(e){var t=f.exec(e);return t&&t[1]||"{anonymous}"}var y=/\s([a-z|A-Z]+)/;function d(e){return void 0===e?"undefined":null===e?"null":Object.prototype.toString.call(e).match(y)[1].toLowerCase()}function v(e,t){void 0===e&&(e=0),void 0===t&&(t=9);var n=Math.random();return 1===n?t:Math.floor(n*(t-e+1))+e}var b={secrets:{}};function g(e,t,n,r,i){var o;if(void 0===t&&(t=8),void 0===n&&(n=!0),void 0===r&&(r=!1),void 0===i&&(i=null),b.secrets.hasOwnProperty(e))(o=b.secrets[e]).indexOf(i);else{var s="";if(n)s=function(e,t){void 0===t&&(t=!1);for(var n="",r=0;r<e;r++){var i,o=v(0,t?35:25);i=o<=25?o+97:o-26+48,n+=String.fromCharCode(i)}return n}(t,r);else if(r)for(var a=0;a<t;a++)s+=v(0,9).toString();o=i?i+s:s,b.secrets[e]=o}return o}var _=function(e,t){return(_=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function m(e,t){function n(){this.constructor=e}_(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var w,O,P=g("ObservableList.markerField",3,!1,!0,"_oL"),j=function(){function e(){}return e.add=function(e,t){var n=[t],r=Array.prototype.push.apply(e,n)-1;e._changedEvent.dispatch(e,{added:n,addedIndex:r,removed:[],removedIndex:-1})},e.remove=function(e,t){var n=Array.prototype.indexOf.call(e,t);if(-1!==n){var r=Array.prototype.splice.call(e,n,1);return e._changedEvent.dispatch(e,{added:[],addedIndex:-1,removed:r,removedIndex:n}),!0}},e}(),E=function(t){function e(e){return void 0===e&&(e=null),t.apply(this,e)||this}return m(e,t),e.isObservableList=function(e){return Object.prototype.hasOwnProperty.call(e,P)&&!0===e[P]},e._markObservable=function(e){Object.defineProperty(e,P,{configurable:!1,enumerable:!1,value:!0,writable:!1})},e.ensureObservable=function(e){return this.isObservableList(e)?e:D.implementObservableList(e)},e.create=function(e){void 0===e&&(e=null);var t=new D(e);return D.ensureObservable(t)},e}(Array),D=function(n){function r(e){void 0===e&&(e=null);var t=n.call(this,e)||this;return r._initFields(t),E._markObservable(t),t}return m(r,n),r._initFields=function(e,t){void 0===t&&(t=null),null==t&&(t=new c),Object.defineProperty(e,"_changedEvent",{configurable:!1,enumerable:!1,value:t,writable:!1})},r.implementObservableList=function(e){return r._initFields(e),e.add=function(e){j.add(this,e)},e.remove=function(e){return j.remove(this,e)},Object.defineProperty(e,"changed",{get:function(){return this._changedEvent.asEvent()}}),r._markObservable(e),e},r.prototype.add=function(e){j.add(this,e)},r.prototype.remove=function(e){return j.remove(this,e)},Object.defineProperty(r.prototype,"changed",{get:function(){return this._changedEvent.asEvent()},enumerable:!0,configurable:!0}),r}(E),T=g("Property.fieldNamePrefix",3,!1,!0,"_fN");(O=w||(w={}))[O.PrototypeWithBackingField=0]="PrototypeWithBackingField",O[O.DirectlyOnObject=1]="DirectlyOnObject";var N=function(){this.changed=new c,this.accessed=new c},S=function(){function t(e,t,n,r,i){this.containingType=e,this.name=t,this.jstype=n,this.isList=!0===r,this.isStatic=!0===i,e.originForNewProperties&&(this._origin=e.originForNewProperties),Object.defineProperty(this,"_eventDispatchers",{value:new N})}return Object.defineProperty(t.prototype,"fieldName",{get:function(){return T+"_"+this.name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"changed",{get:function(){return this._eventDispatchers.changed.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"accessed",{get:function(){return this._eventDispatchers.accessed.asEvent()},enumerable:!0,configurable:!0}),t.prototype.equals=function(e){if(null!=e&&e instanceof t)return this===e},t.prototype.toString=function(){return this.isStatic?this.getPath():"this<"+this.containingType+">."+this.name},t.prototype.isDefinedBy=function(e){return this.containingType===e||e.isSubclassOf(this.containingType)},Object.defineProperty(t.prototype,"origin",{get:function(){return this._origin?this._origin:this.containingType.origin},enumerable:!0,configurable:!0}),t.prototype.getPath=function(){return this.isStatic?this.containingType.fullName+"."+this.name:this.name},t.prototype.canSetValue=function(e,t){if(void 0===t)return console.warn("You should not set property values to undefined, use null instead: property = "+this.name+"."),!0;if(null===t)return!0;if(t.constructor&&t.constructor.meta){for(var n=t.constructor.meta;n;n=n.baseType)if(n.jstype===this.jstype)return!0;return!1}var r=t.constructor;switch(d(t)){case"string":r=String;break;case"number":r=Number;break;case"boolean":r=Boolean;break;case"date":r=Date;break;case"array":r=Array}return r===this.jstype||r===Array&&this.isList&&t.every(function(e){if(e.constructor&&e.constructor.meta){for(var t=e.constructor.meta;t;t=t.baseType)if(t._jstype===this._jstype)return!0;return!1}},this)},t.prototype.value=function(e,t,n){void 0===n&&(n=null);var r=this.isStatic?this.containingType.jstype:e;if(null==r)throw new Error("Cannot "+(1<arguments.length?"set":"get")+" value for "+(this.isStatic?"":"non-")+'static property "'+this.getPath()+'" on type "'+this.containingType.fullName+'": target is null or undefined.');if(!(1<arguments.length))return k(this,r,{});I(this,r,t,{},!1,n)},t.prototype.rootedPath=function(e){if(this.isDefinedBy(e))return this.isStatic?this.containingType.fullName+"."+this.name:this.name},t}();function x(n,r){var i=null,e=!1,o={},s=function(){e||(i=A(n),Array.isArray(i)&&L(r,n,i,o),e=!0)};Object.defineProperty(r,n.name,{configurable:!1,enumerable:!0,get:function(){return s(),n._eventDispatchers.accessed.dispatch(r,{property:n,value:i,state:o}),i},set:function(e){if(s(),C(n,r,i,e)){var t=i;if(n.isList)throw new Error("Property set on lists is not implemented.");i=e,void 0!==t&&n._eventDispatchers.changed.dispatch(r,{property:n,newValue:i,oldValue:t,state:o})}}})}function L(r,i,o,s){o.changed.subscribe(function(e,t){if(t.added&&0<t.added.length||t.removed&&0<t.removed.length){var n={property:i,newValue:o,oldValue:void 0,state:s};n.changes=[{newItems:t.added,oldItems:t.removed}],n.collectionChanged=!0,i._eventDispatchers.changed.dispatch(r,n)}})}function A(e){var t,n,r=(t=e.isList,n=e.jstype,t?[]:n!==Boolean&&(n===Number?0:null));return Array.isArray(r)&&(r=E.ensureObservable(r)),r}function B(e,t,n){if(!t.hasOwnProperty(e.fieldName)){var r=e.isStatic?e.containingType.jstype:t,i=A(e);Object.defineProperty(r,e.fieldName,{value:i,writable:!0}),Array.isArray(i)&&L(t,e,i,n)}}function k(e,t,n,r){return void 0===n&&(n={}),void 0===r&&(r=!1),B(e,t,n),e._eventDispatchers.accessed.dispatch(t,{property:e,value:t[e.fieldName],state:n}),t[e.fieldName]}function I(e,t,n,r,i,o){void 0===r&&(r={}),void 0===i&&(i=!1),void 0===o&&(o=null),B(e,t,r);var s=t[e.fieldName];C(e,t,s,n,i)&&function(e,t,n,r,i,o,s){void 0===o&&(o=!1);void 0===s&&(s=null);{if(e.isList)throw new Error("Property set on lists is not implemented.");if(t[e.fieldName]=r,void 0!==n){var a={property:e,newValue:r,oldValue:n,state:i};if(s)for(var p in s)s.hasOwnProperty(p)&&(a[p]=s[p]);e._eventDispatchers.changed.dispatch(t,a)}}}(e,t,s,n,r,i,o)}function C(e,t,n,r,i){if(void 0===i&&(i=!1),!e.canSetValue(t,r))throw new Error("Cannot set "+e.name+"="+(void 0===r?"<undefined>":r)+" for instance "+t.meta.type.fullName+"|"+t.meta.id+": a value of type "+(e.jstype&&e.jstype.meta?e.jstype.meta.fullName:h(e.jstype))+" was expected.");if(e.isList)throw new Error("Property set on lists is not permitted.");var o=null==n?n:n.valueOf(),s=null==r?r:r.valueOf();return o!==s&&!(e.jstype===Number&&isNaN(o)&&isNaN(s))}function M(e,t,n,r){return void 0===r&&(r=!1),function(){return t(e,this,n,r)}}function F(t,n,r,i){return void 0===i&&(i=!1),function(e){n(t,this,e,r,i)}}var W=function(){function e(e,t,n,r){Object.defineProperty(this,"type",{value:e,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this,"entity",{value:t,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this,"id",{value:n,writable:!0,enumerable:!0,configurable:!1}),Object.defineProperty(this,"isNew",{value:r,writable:!0,enumerable:!0,configurable:!1})}return e.prototype.destroy=function(){this.type.unregister(this.entity);for(var e=this.type;e;e=e.baseType)e._eventDispatchers.destroy.dispatch(e,{entity:this.entity})},e}(),V="+c",H=function(){this.initNew=new c,this.initExisting=new c,this.initNew=new c},R=function(){function e(e,t,n,r){this.model=e,this.fullName=t,Object.defineProperty(this,"_eventDispatchers",{value:new H}),this._properties={},this.origin=r||"client",this.originForNewProperties=this.origin,this._pool={},this._legacyPool={},this._counter=0,Object.defineProperty(this,"rules",{value:[]});for(var i=Y.getJsType(t,!0),o=t.split("."),s=o.shift(),a=z,p=window;0<o.length;)a=l(s,a),p=l(s,p),s=o.shift();var u,c,f=s;i=function(e,t,n){if(!J)if(e&&e.constructor===String){var r=e,i=u.get(r,!0);if(i)return t&&i.init(t),i;u.register(this,r,n),t&&this.init(t);for(var o=u;o;o=o.baseType)o._eventDispatchers.initExisting.dispatch(o,{entity:this})}else{u.register(this,null,n),e&&this.set(e);for(var o=u;o;o=o.baseType)o._eventDispatchers.initNew.dispatch(o,{entity:this})}},(u=this)._jstype=i,a[f]?a["$"+f]=i:a[f]=i,p[f]?p["$"+f]=i:p[f]=i,this.derivedTypes=[],n?(c=n._jstype,(this.baseType=n).derivedTypes.push(this)):(c=Z,this.baseType=null),J=!0,this._jstype.prototype=new c,J=!1,this._jstype.prototype.constructor=this._jstype,Object.defineProperty(i,"meta",{value:this,configurable:!1,enumerable:!1,writable:!1}),e._types[t]=this}return Object.defineProperty(e.prototype,"destroyEvent",{get:function(){return this._eventDispatchers.destroy.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initNewEvent",{get:function(){return this._eventDispatchers.initNew.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initExistingEvent",{get:function(){return this._eventDispatchers.initExisting.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e,"newIdPrefix",{get:function(){return V.substring(1)},set:function(e){if("string"!=typeof e)throw new TypeError("Property `Type.newIdPrefix` must be a string, found <"+typeof e+">");if(0===e.length)throw new Error("Property `Type.newIdPrefix` cannot be empty string");V="+"+e},enumerable:!0,configurable:!0}),e.prototype.newId=function(){for(var e,t=this;t;t=t.baseType)e=Math.max(e||0,t._counter);for(t=this;t;t=t.baseType)t._counter=e+1;return V+e},e.prototype.register=function(e,t,n){var r;void 0===n&&(n=!1),2===arguments.length&&U(this,t),t||(t=this.newId(),r=!0),Object.defineProperty(e,"meta",{value:new W(this,e,t,r),configurable:!1,enumerable:!1,writable:!1});for(var i=t.toLowerCase(),o=this;o;o=o.baseType){if(o._pool.hasOwnProperty(i))throw new Error('Object "'+this.fullName+"|"+t+'" has already been registered.');o._pool[i]=e,o._known&&o._known.add(e)}if(this.model._settings.propertyTarget==w.DirectlyOnObject)for(var s in this._properties)if(Object.prototype.hasOwnProperty.call(this._properties,s)){var a=this._properties[s];a.isStatic||x(a,e)}n||this.model._eventDispatchers.entityRegistered.dispatch(this.model,{entity:e})},e.prototype.changeObjectId=function(e,t){U(this,e),U(this,t);var n=e.toLowerCase(),r=t.toLowerCase(),i=this._pool[n];if(i){i.meta._legacyId=e;for(var o=this;o;o=o.baseType)o._pool[r]=i,delete o._pool[n],o._legacyPool[n]=i;return i.meta.id=t,i}console.warn('Attempting to change id: Instance of type "'+this.fullName+'" with id = "'+e+'" could not be found.')},e.prototype.unregister=function(e){for(var t=this;t;t=t.baseType)delete t._pool[e.meta.id.toLowerCase()],e.meta._legacyId&&delete t._legacyPool[e.meta._legacyId.toLowerCase()],t._known&&t._known.remove(e);this.model._eventDispatchers.entityUnregistered.dispatch(this.model,{entity:e})},e.prototype.get=function(e,t){var n=e.toLowerCase(),r=this._pool[n]||this._legacyPool[n];if(r&&!0===t&&r.meta.type!==this)throw new Error("The entity with id='"+e+"' is expected to be of type '"+this.fullName+"' but found type '"+r.meta.type.fullName+"'.");return r},e.prototype.known=function(){var e=this._known;if(!e){var t=[];for(var n in this._pool)Object.prototype.hasOwnProperty.call(this._pool,n)&&t.push(this._pool[n]);e=this._known=E.ensureObservable(t)}return e},Object.defineProperty(e.prototype,"jstype",{get:function(){return this._jstype},enumerable:!0,configurable:!0}),e.prototype.addProperty=function(e,t,n,r){var i,o,s,a,p=new S(this,e,t,n,r);if((this._properties[e]=p).isStatic)s=p,a={},Object.defineProperty(s.containingType.jstype,s.name,{configurable:!1,enumerable:!0,get:M(s,k,a,!0),set:F(s,I,a)});else if(this.model._settings.propertyTarget===w.DirectlyOnObject)for(var u in this._pool)Object.prototype.hasOwnProperty.call(this._pool,u)&&x(p,this._pool[u]);else i=p,o={},Object.defineProperty(i.containingType.jstype.prototype,i.name,{configurable:!1,enumerable:!0,get:M(i,k,o,!0),set:F(i,I,o)});return this.model._eventDispatchers.propertyAdded.dispatch(this.model,{property:p}),p},e.prototype.property=function(e){for(var t,n=this;n&&!t;n=n.baseType)if(t=n._properties[e])return t;return null},Object.defineProperty(e.prototype,"properties",{get:function(){for(var e=[],t=this;null!=t;t=t.baseType)for(var n in t._properties)t._properties.hasOwnProperty(n)&&e.push(t._properties[n]);return e},enumerable:!0,configurable:!0}),e.prototype.isSubclassOf=function(t){var n=!1;return function(e,t,n,r){void 0===r&&(r=null);for(var i=e[t];null!=i;i=i[t])if(!1===n.call(r||e,i))return}(this,"baseType",function(e){if(e===t)return!(n=!0)}),n},e.prototype.toString=function(){return this.fullName},e}();function U(e,t){if(null==t)throw new Error("Id cannot be "+(null===t?"null":"undefined")+" (entity = "+e.fullName+").");if("string"!==d(t))throw new Error("Id must be a string:  encountered id "+t+' of type "'+h(t.constructor)+'" (entity = '+e.fullName+").");if(""===t)throw new Error("Id cannot be a blank string (entity = "+e.fullName+").")}var J=!1;var $=["Object","String","Number","Boolean","Date","TimeSpan","Array"],q=function(){this.typeAdded=new c,this.entityRegistered=new c,this.entityUnregistered=new c,this.propertyAdded=new c},z={},Y=function(){function e(e){void 0===e&&(e=null),Object.defineProperty(this,"_types",{value:{}}),Object.defineProperty(this,"_settings",{value:this.convertOptions(e)}),Object.defineProperty(this,"_eventDispatchers",{value:new q})}return e.prototype.convertOptions=function(e){void 0===e&&(e=null);var t={propertyTarget:w.PrototypeWithBackingField};if(e&&e.propertyTarget)if("number"==typeof e.propertyTarget)t.propertyTarget=e.propertyTarget;else if("string"==typeof e.propertyTarget){var n=e.propertyTarget.toLowerCase();n===w[w.PrototypeWithBackingField].toLowerCase()?t.propertyTarget=w.PrototypeWithBackingField:n===w[w.DirectlyOnObject].toLowerCase()&&(t.propertyTarget=w.DirectlyOnObject)}return t},Object.defineProperty(e.prototype,"typeAddedEvent",{get:function(){return this._eventDispatchers.typeAdded.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entityRegisteredEvent",{get:function(){return this._eventDispatchers.entityRegistered.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"entityUnregisteredEvent",{get:function(){return this._eventDispatchers.entityUnregistered.asEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"propertyAddedEvent",{get:function(){return this._eventDispatchers.propertyAdded.asEvent()},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){},Object.defineProperty(e.prototype,"types",{get:function(){var e=[];for(var t in this._types)this._types.hasOwnProperty(t)&&e.push(this._types[t]);return e},enumerable:!0,configurable:!0}),e.prototype.addType=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n="client");var r=new R(this,e,t,n);return this._types[e]=r,this._eventDispatchers.typeAdded.dispatch(this,{type:r}),r},e.getJsType=function(e,t){void 0===t&&(t=!1);var n=z,r=e.split(".");if(1===r.length&&-1<$.indexOf(e))return window[e];for(var i=0;i<r.length;i++){var o=r[i];if(void 0===(n=n[o])){if(t)return;throw new Error('The type "'+e+'" could not be found.  Failed on step "'+o+'".')}}return n},e}(),Z=function(){function t(){}return t.prototype.init=function(e,t){var n;for(var r in"string"==typeof e?(n={})[e]=t:n=e,n){var i=this.meta.type.property(r);if(!i)throw new Error('Could not find property "'+r+'" on type "'+this.meta.type.fullName+'".');i.value(this,t)}},t.prototype.set=function(e,t){var n;for(var r in"string"==typeof e?(n={})[e]=t:n=e,n){var i=this.meta.type.property(r);if(!i)throw new Error('Could not find property "'+r+'" on type "'+this.meta.type.fullName+'".');i.set(this,t,!1)}},t.prototype.get=function(e){return this.meta.type.property(e).value(this)},t.prototype.toString=function(e){return e?e.convert(this):t.toIdString(this)},t.toIdString=function(e){return e.meta.type.fullName+"|"+e.meta.id},t.fromIdString=function(e){var t=e.substring(0,e.indexOf("|")),n=e.substring(t.length+1);return Y.getJsType(t).meta.get(n,!1)},t}();e.Entity=Z,e.Property=S,e.Type=R,e.Model=Y,Object.defineProperty(e,"__esModule",{value:!0})});
